{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<h2 class="mb-4">ğŸ“Š Thá»‘ng kÃª há»‡ thá»‘ng</h2>

<!-- Cards thá»‘ng kÃª -->
<div class="row text-center mb-5">
  <div class="col-md-3">
    <div class="card text-bg-primary shadow">
      <div class="card-body">
        <h5 class="card-title">ğŸ“š SÃ¡ch</h5>
        <p class="fs-2">{{ stats.books }}</p>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card text-bg-success shadow">
      <div class="card-body">
        <h5 class="card-title">âœï¸ TÃ¡c giáº£</h5>
        <p class="fs-2">{{ stats.authors }}</p>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card text-bg-warning shadow">
      <div class="card-body">
        <h5 class="card-title">ğŸ‘¥ Äá»™c giáº£</h5>
        <p class="fs-2">{{ stats.borrowers }}</p>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card text-bg-danger shadow">
      <div class="card-body">
        <h5 class="card-title">ğŸ“– LÆ°á»£t mÆ°á»£n</h5>
        <p class="fs-2">{{ stats.loans }}</p>
      </div>
    </div>
  </div>
</div>

<!-- Biá»ƒu Ä‘á»“ Chart.js -->
<div class="row">
  <div class="col-md-6">
    <div class="card shadow mb-4">
      <div class="card-body">
        <h5 class="card-title">Biá»ƒu Ä‘á»“ sá»‘ lÆ°á»£ng</h5>
        <canvas id="barChart"></canvas>
      </div>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card shadow mb-4">
      <div class="card-body">
        <h5 class="card-title">Tá»‰ lá»‡ pháº§n trÄƒm</h5>
        <canvas id="pieChart"></canvas>
      </div>
    </div>
  </div>
</div>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const dataCounts = {
    books: {{ stats.books }},
    authors: {{ stats.authors }},
    borrowers: {{ stats.borrowers }},
    loans: {{ stats.loans }}
  };

  // Biá»ƒu Ä‘á»“ cá»™t
  new Chart(document.getElementById('barChart'), {
    type: 'bar',
    data: {
      labels: ['SÃ¡ch', 'TÃ¡c giáº£', 'Äá»™c giáº£', 'LÆ°á»£t mÆ°á»£n'],
      datasets: [{
        label: 'Sá»‘ lÆ°á»£ng',
        data: [dataCounts.books, dataCounts.authors, dataCounts.borrowers, dataCounts.loans],
        backgroundColor: ['#0d6efd','#198754','#ffc107','#dc3545']
      }]
    },
    options: {
      responsive: true,
      plugins: { legend: { display: false } }
    }
  });

  // Biá»ƒu Ä‘á»“ trÃ²n
  new Chart(document.getElementById('pieChart'), {
    type: 'pie',
    data: {
      labels: ['SÃ¡ch', 'TÃ¡c giáº£', 'Äá»™c giáº£', 'LÆ°á»£t mÆ°á»£n'],
      datasets: [{
        data: [dataCounts.books, dataCounts.authors, dataCounts.borrowers, dataCounts.loans],
        backgroundColor: ['#0d6efd','#198754','#ffc107','#dc3545']
      }]
    },
    options: { responsive: true }
  });
</script>
{% endblock %}
